this.Shopify=this.Shopify||{},this.Shopify.theme=this.Shopify.theme||{},this.Shopify.theme.productForm=function(t,e){"use strict";function i(){this.entries=[]}i.prototype.add=function(t,e,n){this.entries.push({element:t,event:e,fn:n}),t.addEventListener(e,n)},i.prototype.removeAll=function(){this.entries=this.entries.filter(function(t){return t.element.removeEventListener(t.event,t.fn),!1})};var n='[name="id"]',o='[name^="options"]',r='[name="quantity"]',s='[name^="properties"]';function u(t,e,n){this.element=t,this.product=function(t){if("object"!=typeof t)throw new TypeError(t+" is not an object.");if(void 0!==t.variants[0].options)return t;throw new TypeError("Product object is invalid. Make sure you use the product object that is output from {{ product | json }} or from the http://[your-product-url].js route")}(e),n=n||{},this._listeners=new i,this._listeners.add(this.element,"submit",this._onSubmit.bind(this,n)),this.optionInputs=this._initInputs(o,n.onOptionChange),this.quantityInputs=this._initInputs(r,n.onQuantityChange),this.propertyInputs=this._initInputs(s,n.onPropertyChange)}return u.prototype.destroy=function(){this._listeners.removeAll()},u.prototype.options=function(){return t=this.optionInputs,n=function(t){return t.name=/(?:^(options\[))(.*?)(?:\])/.exec(t.name)[2],t},t.reduce(function(t,e){return(e.checked||"radio"!==e.type&&"checkbox"!==e.type)&&t.push(n({name:e.name,value:e.value})),t},[]);var t,n},u.prototype.variant=function(){return e.getVariantFromSerializedArray(this.product,this.options())},u.prototype.properties=function(){var t,n,e=(t=this.propertyInputs,n=function(t){return/(?:^(properties\[))(.*?)(?:\])/.exec(t)[2]},t.reduce(function(t,e){return(e.checked||"radio"!==e.type&&"checkbox"!==e.type)&&(t[n(e.name)]=e.value),t},{}));return 0===Object.entries(e).length?null:e},u.prototype.quantity=function(){return this.quantityInputs[0]?Number.parseInt(this.quantityInputs[0].value,10):1},u.prototype._setIdInputValue=function(t){var e=this.element.querySelector(n);e||((e=document.createElement("input")).type="hidden",e.name="id",this.element.appendChild(e)),e.value=t.toString()},u.prototype._onSubmit=function(t,e){e.dataset=this._getProductFormEventData(),e.dataset.variant&&this._setIdInputValue(e.dataset.variant.id),t.onFormSubmit&&t.onFormSubmit(e)},u.prototype._onFormEvent=function(e){return void 0===e?Function.prototype:function(t){t.dataset=this._getProductFormEventData(),e(t)}.bind(this)},u.prototype._initInputs=function(t,e){return Array.prototype.slice.call(this.element.querySelectorAll(t)).map(function(t){return this._listeners.add(t,"change",this._onFormEvent(e)),t}.bind(this))},u.prototype._getProductFormEventData=function(){return{options:this.options(),variant:this.variant(),properties:this.properties(),quantity:this.quantity()}},t.getUrlWithVariant=function(t,e){return/variant=/.test(t)?t.replace(/(variant=)[^&]+/,"$1"+e):/\?/.test(t)?t.concat("&variant=").concat(e):t.concat("?variant=").concat(e)},t.ProductForm=u,t}({},Shopify.theme.product);
